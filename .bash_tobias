#!/bin/bash

source ~/.git-cd/gitcd.sh
source ~/.git-completion.bash

# bash-git-prompt
export GIT_PROMPT_ONLY_IN_REPO=0
# GIT_PROMPT_FETCH_REMOTE_STATUS=0   # uncomment to avoid fetching remote status
# GIT_PROMPT_START=...    # uncomment for custom prompt start sequence
# GIT_PROMPT_END=...      # uncomment for custom prompt end sequence
# GIT_PROMPT_THEME=Custom # use custom .git-prompt-colors.sh
# GIT_PROMPT_THEME=Solarized # use theme optimized for solarized color scheme
source ~/.bash-git-prompt/gitprompt.sh

export GOPATH="$HOME/go"
export PATH="$PATH:$GOPATH/bin:$HOME/rust/bin"

mkdir -p "${HOME}/.history"
export HISTFILE="${HOME}/.history/$(date -u +%Y/%m/%d.%H.%M.%S)_${HOSTNAME_SHORT}_$$"

alias g=git
alias gcd=gitcd
alias ccd="cd ${GOPATH}/src/github.com/cockroachdb/cockroach"

function rt() { PKG="${1}" && TESTS="${2}" && shift && shift && rm -f "${PKG}.test" && make test TESTFLAGS=-c PKG=./${PKG} && while [ $? -eq 0 ]; do echo -n "." && (OUT=$(./${PKG}.test --test.run "${TESTS}" --test.timeout=5s "$@" 2>&1) || (echo "${OUT}" && false)); done }

__git_complete g __git_main
